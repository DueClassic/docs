é¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜é—®äº†ä¸€ä¸ªå¾ˆå¸¸è§çš„TopNç®—æ³•ï¼Œæˆ‘å´å‚»äº†ã€‚ç®—æ³•æ˜¯é¢è¯•å®˜ç»å¸¸è€ƒæ ¸çš„å†…å®¹ï¼Œæ‰€ä»¥å†³å®šä¸“é—¨æ¥é€šè¿‡å†™æ–‡æ¡£æŠŠå¸¸è§çš„ç®—æ³•é¢è¯•é¢˜ç»™å­¦ä¹ ä¸€ä¸‹ã€‚

##### TopNç®—æ³•ä¸æ’è¡Œæ¦œ

> åœ¨ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼š**å°†å¤§é‡ï¼ˆæ¯”å¦‚å‡ åä¸‡ã€ç”šè‡³ä¸Šç™¾ä¸‡ï¼‰çš„å¯¹è±¡è¿›è¡Œæ’åºï¼Œç„¶ååªéœ€è¦å–å‡ºæœ€Topçš„å‰Nåä½œä¸ºæ’è¡Œæ¦œçš„æ•°æ®ï¼Œè¿™å³æ˜¯ä¸€ä¸ªTopNç®—æ³•**ã€‚
>
> ä½¿ç”¨æœ€å°å †æ’åºï¼Œç„¶åå–å‡ºå‰Nåã€‚

##### å †çš„ä»‹ç»

Heapæ˜¯ä¸€ç§æ•°æ®ç»“æ„ä¸”å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. å®Œå…¨äºŒå‰æ ‘
2. heapä¸­å­˜å‚¨çš„å€¼æ˜¯ååº

Min-heapï¼šçˆ¶èŠ‚ç‚¹çš„å€¼å°äºæˆ–ç­‰äºå­èŠ‚ç‚¹çš„å€¼ï¼ˆæŸ¥æ‰¾æœ€å¤§çš„Nä¸ªå…ƒç´ ï¼‰

Max-heapï¼šçˆ¶èŠ‚ç‚¹çš„å€¼å¤§äºæˆ–ç­‰äºå­èŠ‚ç‚¹çš„å€¼ï¼ˆæŸ¥æ‰¾æœ€å°çš„Nä¸ªå…ƒç´ ï¼‰

![etb9akjwsn](../../media/etb9akjwsn.png)

##### å †çš„å­˜å‚¨

ä¸€èˆ¬ç”¨æ•°ç»„æ¥è¡¨ç¤ºå †ï¼Œi èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸‹æ ‡å°±ä¸º**(i-1)/2**ã€‚å®ƒçš„å·¦å³èŠ‚ç‚¹ä¸‹æ ‡åˆ†åˆ«ä¸º**2*i+1**å’Œ**2*i+2**ã€‚

![æœ€å¤§å †](../../media/QQæˆªå›¾20200624224521.png)

ç”±äºå †å­˜å‚¨åœ¨ä¸‹æ ‡ä»0å¼€å§‹è®¡æ•°çš„åœ¨æ•°ç»„ä¸­ï¼Œå› æ­¤ï¼Œåœ¨å †ä¸­ç»™å®šä¸‹æ ‡ä¸ºiçš„èŠ‚ç‚¹æ—¶ï¼š

1. å¦‚æœi=0ï¼ŒèŠ‚ç‚¹iæ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ— çˆ¶èŠ‚ç‚¹ï¼›å¦åˆ™èŠ‚ç‚¹içš„çˆ¶èŠ‚ç‚¹ä¸ºèŠ‚ç‚¹(i-1)/2ï¼›
2. å¦‚æœ2i+1>n-1ï¼Œåˆ™èŠ‚ç‚¹iæ— å·¦å­å¥³ï¼›å¦åˆ™èŠ‚ç‚¹içš„å·¦å­å¥³ä¸ºèŠ‚ç‚¹2i+1ï¼›
3. å¦‚æœ2i+2>n-1ï¼Œåˆ™èŠ‚ç‚¹iæ— å³èŠ‚ç‚¹ï¼›å¦åˆ™èŠ‚ç‚¹çš„å³å­å¥³ä¸ºèŠ‚ç‚¹2i+2ã€‚

æ¯”å¦‚56çš„ä¸‹æ ‡ä¸º2ï¼Œ**2*2+2>5**ï¼Œåˆ™æ— å³èŠ‚ç‚¹ã€‚

##### å †çš„æ“ä½œï¼šæ’å…¥å…ƒç´ 

æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼š**æ–°å…ƒç´ è¢«åŠ å…¥åˆ°heapçš„æœ«å°¾ï¼Œç„¶åæ›´æ–°æ ‘ä»¥æ¢å¤å †çš„é¡ºåºã€‚**

![QQæˆªå›¾20200624221842](../../media/QQæˆªå›¾20200624224757.png)

##### å †çš„æ“ä½œï¼šåˆ é™¤å…ƒç´ 

**æœ€å°å †çš„åˆ é™¤æ“ä½œï¼Œæ€»æ˜¯æŒ‰ç…§å †çš„æ ¹èŠ‚ç‚¹åˆ é™¤å…ƒç´ **ã€‚ä¸ºäº†ä¾¿äºé‡å»ºå †ï¼Œ**å®é™…çš„æ“ä½œæ˜¯å°†æœ€åä¸€ä¸ªæ•°æ®çš„å€¼èµ‹ç»™æ ¹èŠ‚ç‚¹ï¼Œç„¶åä»æ ¹èŠ‚ç‚¹å¼€å§‹ä¸€æ¬¡ä»ä¸Šå‘ä¸‹çš„è°ƒæ•´ã€‚**

![QQæˆªå›¾20200624223538](../../media/QQæˆªå›¾20200624225439.png)

##### å †çš„æ“ä½œï¼šåˆ›å»ºå †

 åˆ›å»ºæœ€å°å †æœ‰ä¸¤ç§æ–¹æ³•ï¼š 

1. å…ˆåˆ›å»ºä¸€ä¸ªç©ºå †ï¼Œç„¶åæ ¹æ®å…ƒç´ ä¸€ä¸ªä¸€ä¸ªå»æ’å…¥èŠ‚ç‚¹ã€‚ç”±äºæ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º**O(log2(n))**ï¼Œç„¶ånä¸ªå…ƒç´ æ’å…¥è¿›å»ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º**O(n*log2(n))**ã€‚
2. å°†è¿™nä¸ªå…ƒç´ å…ˆæŒ‰é¡ºåºæ”¾å…¥ä¸€ä¸ªäºŒå‰æ ‘ä¸­å½¢æˆä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼Œç„¶åè°ƒæ•´å„ä¸ªèŠ‚ç‚¹çš„ä½ç½®æ¥æ»¡è¶³æœ€å¤§å †çš„ç‰¹æ€§ã€‚

æœ€å¤§å †æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯å…¶å„ä¸ªå­æ ‘éƒ½æ˜¯ä¸€ä¸ªæœ€å¤§å †ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»æœ€å°å­—æ•°è½¬æ¢æˆä¸€ä¸ªæœ€å¤§å †ï¼Œç„¶åä¾æ¬¡è½¬æ¢å®ƒçš„çˆ¶èŠ‚ç‚¹å¯¹åº”çš„å­æ ‘ï¼Œç›´åˆ°æœ€åçš„æ ¹èŠ‚ç‚¹æ‰€åœ¨çš„æ•´ä¸ªå®Œå…¨äºŒå‰æ ‘å˜æˆæœ€å¤§å †ã€‚

é‚£ä¹ˆå°±æŒ‰ç…§æ–¹æ³•2æ¥æ„å»ºæœ€å°å †å§ï¼

å…·ä½“æ­¥éª¤ï¼š

ï½›30ï¼Œ25ï¼Œ70ï¼Œ10ï¼Œ15ï¼Œ56ï½å°†è¿™6ä¸ªæ•°å­—æ”¾å…¥ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œå¦‚ä¸‹ï¼š

![QQæˆªå›¾20200624233400](../../media/QQæˆªå›¾20200624233400.png)

1.æ‰¾åˆ°äºŒå‰æ ‘ä¸­å€’æ•°ç¬¬ä¸€ä¸ªéå¶å­èŠ‚ç‚¹**70**ï¼Œç„¶åä»¥è¯¥éå¶å­èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ï¼ŒæŸ¥çœ‹è¯¥å­æ ‘æ˜¯å¦æ»¡è¶³æœ€å°å †è¦æ±‚ï¼Œå¾ˆæ˜æ˜¾ç›®å‰è¯¥å­æ ‘ä¸æ»¡è¶³æœ€å°å †ï¼Œæ‰€ä»¥éœ€è¦ç§»åŠ¨èŠ‚ç‚¹ã€‚è¯¥å­æ ‘æœ€å¤§ç§»åŠ¨æ¬¡æ•°ä¸º1ã€‚

![QQæˆªå›¾20200624233925](../../media/QQæˆªå›¾20200624233925.png)

2. æ¥åˆ°èŠ‚ç‚¹25ï¼Œåšç±»ä¼¼æ“ä½œï¼ˆè¯¥å­æ ‘æœ€å¤§ç§»åŠ¨æ¬¡æ•°ä¸º1ï¼‰ï¼š

![QQæˆªå›¾20200624234302](../../media/QQæˆªå›¾20200624234302.png)

3. æ¥åˆ°èŠ‚ç‚¹30ï¼Œå¯¹è¯¥å­æ ‘åšåŒæ ·æ“ä½œï¼ˆè¯¥å­æ ‘æœ€å¤§ç§»åŠ¨æ¬¡æ•°ä¸º2ï¼‰ï¼š

![QQæˆªå›¾20200624234907](../../media/QQæˆªå›¾20200624234907.png)

å³åˆ›å»ºçš„æœ€å°é˜Ÿå¦‚å›¾ä¸Šï¼ˆæœ€å¤§ç§»åŠ¨æ¬¡æ•°ä¸º4æ¬¡ã€‚ï¼‰ ï¼›                                                                                ğŸ‘† 

##### å †çš„æ“ä½œï¼šå †çš„æ’åº

å¦‚æœæ˜¯ä»å¤§åˆ°å°æ’åºï¼Œåˆ›å»ºæœ€å°å †åï¼Œç¬¬0ä¸ªæ•°æ®å°±æ˜¯å †ä¸­æœ€å°çš„æ•°æ®ã€‚å–å‡ºè¿™ä¸ªæ•°æ®ï¼Œæ”¾åœ¨æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå°†å½“å‰å…ƒç´ æ€»æ•°å‡ä¸€ï¼Œå†æ‰§è¡Œä¸‹æ¨çš„åˆ é™¤æ“ä½œï¼Œè¿™æ ·å †ä¸­çš„ç¬¬0ä¸ªæ•°æ®åˆæ˜¯å †ä¸­æœ€å°çš„æ•°æ®ï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ç›´è‡³å †ä¸­åªæœ‰ä¸€ä¸ªæ•°æ®æ—¶ï¼Œæ•°ç»„å…ƒç´ å°±å·²ç»æœ‰åºã€‚

æ¼”ç¤ºï¼š

æœ€å°å †ï¼š

![QQæˆªå›¾20200625002334](../../media/QQæˆªå›¾20200625002334.png)

1. æŠŠæ ¹èŠ‚ç‚¹10â€œåˆ é™¤â€ï¼Œç¬¬ä¸€æ¬¡æ’åºå¦‚å›¾ï¼š

![QQæˆªå›¾20200625002213](../../media/QQæˆªå›¾20200625002213.png)

2. èŠ‚ç‚¹15è¿›è¡Œç›¸åŒæ“ä½œï¼š

![QQæˆªå›¾20200625002924](../../media/QQæˆªå›¾20200625002924.png)

3. ã€‚ã€‚ã€‚

![QQæˆªå›¾20200625004140](../../media/QQæˆªå›¾20200625004140.png)

ç»è¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæœ€åå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ’åºç»“æœï¼š

```java
{70,56,30,25,15,10}
```

- æ—¶é—´å¤æ‚åº¦ï¼šO(*nlgn*)
- ç©ºé—´å¤æ‚åº¦ï¼šO(1)

##### ä½¿ç”¨å †æ’åº

> æˆ‘ä»¬æŒ‡å®šè·å–å‰Nä¸ªæœ€å¤§çš„æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„å»ºä¸€æœ‰Nä¸ªèŠ‚ç‚¹çš„å°æ ¹å †ï¼Œéå†ç™¾ä¸‡çº§æ•°ç»„ï¼Œç”¨æ•°ç»„å»å’Œå°æ ¹å †çš„æ ¹èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ¯”æ ¹èŠ‚ç‚¹å¤§ï¼Œåˆ™æ›¿æ¢æ ¹èŠ‚ç‚¹ï¼Œç„¶åé‡å»ºå°æ ¹å †ï¼Œç»´æŠ¤å°æ ¹å †çš„æ€§è´¨ï¼Œä¿è¯æ ¹èŠ‚ç‚¹åœ¨å †ä¸­æœ€å°ï¼Œéå†å®Œæˆåï¼Œå †ä¸­æ•°å­—åˆ™ä¸ºæ•°ç»„ä¸­æœ€å¤§æ•°å­—ã€‚

##### ä»£ç å®ç°ï¼š

```java
package com.dueclassic.algorithm.sort;

import java.util.Arrays;
import java.util.Random;

public class TopN {

    public static void main(String[] args) {
        //é¦–å…ˆåˆ›å»ºä¸€ä¸ªå«100000ä¸ªæµ®ç‚¹æ•°çš„æ•°ç»„ã€‚
        float arr[]=new float[100000];
        Random random=new Random();
        float v;
        for (int i=0;i<100000;i++){
            v=random.nextFloat()*10f;
            arr[i]=v;
        }
        long start=System.currentTimeMillis();
        //è·å–å…¶æœ€å¤§çš„å‰ä¸€ç™¾ä¸ª
        float[] maxNumArr=getMaxNum(100,arr);
        //å¯¹è¿™ä¸€ç™¾ä¸ªè¿›è¡Œå †æ’åº
        heapSort(maxNumArr);
        print(maxNumArr);
        System.out.println("èŠ±è´¹æ—¶é—´ï¼š"+(System.currentTimeMillis()-start));
    }

    //æ ¸å¿ƒæ–¹æ³•
    private static float[] getMaxNum(int count,float[] data){
        float[] maxNumArr= Arrays.copyOfRange(data,0,count);
        //1.å…ˆæ„é€ å°æ ¹å †
        createMindHeap(maxNumArr,count-1);
        //2.ç»´æŠ¤å°æ ¹å †
        for (int i=100;i<data.length-1;i++){
            //å¦‚æœå€¼å¤§äºæœ€å°å †çš„æœ€å°å€¼ï¼Œåˆ™æ·»åŠ è¯¥å€¼ï¼Œç»´æŠ¤æœ€å°å †
            if (data[i]>maxNumArr[0]){
                maxNumArr[0]=data[i];
                buildMindHeap(maxNumArr,count-1);
            }
        }
        return maxNumArr;
    }

    //æ„é€ å°æ ¹å †
    private static void createMindHeap(float[] num,int lastIndex){
        for (int i=(num.length-1)/2;i>=0;i--){
            heapCompare(i,num,lastIndex);
        }
    }

    //ç»´æŠ¤å°æ ¹å †
    private static void buildMindHeap(float[] data,int lastIndex){
        int i=0;
        heapCompare(i,data,lastIndex);
    }

    //å †ä¸‹æ²‰
    private static void heapCompare(int i,float[] num,int lastIndex){
        //0.åˆ¤æ–­æ˜¯å¦è¶…å‡ºæ•°ç»„èŒƒå›´
        while (i*2+1<=lastIndex){
            int index=i*2+1;
            int rightIndex=index+1;
            //1.åˆ¤æ–­å³èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨
            if (rightIndex<=lastIndex){
                //2.åˆ¤æ–­å·¦å³èŠ‚ç‚¹å¤§å°
                if (num[index]>num[rightIndex]){
                    //å¦‚æœå³èŠ‚ç‚¹å€¼æ¯”è¾ƒå°ï¼Œåˆ™ä½¿ç”¨å³èŠ‚ç‚¹å€¼æ¥ä¸çˆ¶èŠ‚ç‚¹çš„å€¼æ¥ä½œæ¯”è¾ƒ
                    index=rightIndex;
                }
            }
            //3.åˆ¤è¯»çˆ¶èŠ‚ç‚¹å’Œå…¶å­èŠ‚ç‚¹ä¸­å°çš„èŠ‚ç‚¹ä½œæ¯”è¾ƒï¼Œå¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹å¤§ï¼Œåˆ™åšä¸‹ä¸€å›åˆçš„æ¯”è¾ƒï¼Œå¦åˆ™ï¼Œé€€å‡ºå¾ªç¯
            if (num[i]>num[index]){
                swap(num,i,index);
                i=index;
            }else {
                break;
            }
        }
    }

    //å°æ ¹å †æ’åº
    private static void heapSort(float[] data){
        for (int i=0;i<data.length-1;i++){
            //æ¯æ¬¡å°†æœ€å°çš„æ•°å­—æ”¾åœ¨æœ€åï¼Œç„¶åä½¿ç”¨å‰©ä¸‹çš„æ•°ç»„è¿›è¡Œå †æ’åº
            buildMindHeap(data,data.length-1-i);
            swap(data,0,data.length-1-i);
        }
    }

    //äº¤æ¢å…ƒç´ 
    private static void swap(float[] data,int i,int j){
        if (i==j){
            return;
        }
        float temp=data[i];
        data[i]=data[j];
        data[j]=temp;
    }

    //è¾“å‡ºæ•°ç»„
    private static void print(float[] data){
        for (int i=0;i<data.length;i++){
            System.out.println(data[i]+" ");
        }
    }
}

```



##### å‚è€ƒ

- [æœ€å¤§å †ï¼ˆåˆ›å»ºã€åˆ é™¤ã€æ’å…¥å’Œå †æ’åºï¼‰]( https://www.jianshu.com/p/21bef3fc3030 )
- [å°æ ¹å †(Heap)çš„è¯¦ç»†å®ç°](https://www.cnblogs.com/WindSun/p/11444446.html)
- [æ•°æ®ç»“æ„â€”â€”å †ï¼ˆHeapï¼‰å¤§æ ¹å †ã€å°æ ¹å †]( https://www.cnblogs.com/wangchaowei/p/8288216.html )
- [å †æ’åºå®ç°ç™¾ä¸‡çº§æ•°æ®å–è‹¥å¹²æ•°é‡çš„æœ€å¤§æ•°å­—ï¼ˆjavaï¼‰]( https://blog.csdn.net/jayzym/article/details/79494900?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase )

##### å·¥å…·

- [ProcessOn]( https://www.processon.com/diagrams )